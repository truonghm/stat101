[["index.html", "Gii thiu c bn v XSTK Preface", " Gii thiu c bn v XSTK Truong Hoang Thaìng MýõÌi Hai 17, 2020 Preface This document is my studying notes for the subject of Statistical Methodologies. I intend this to be the first part of my learning journey, which I call STAT101. Please note the emphasis on studying notes, which means that this is personal and not meant for distribution for other people to use. Im not a qualified educator in any ways, so if you happen upon this page, please keep that in mind. The entire document is in Vietnamese, with this page being the only exception. I like to start with English, for personal reasons. I use several books to study the subject. Please find the full list below. Everything is built with bookdown in R and uploaded to Github Pages. "],["motivation.html", "Motivation", " Motivation I admit it, I have a rather slow mind for learning. This could either stem from my (undiagnosed) ADHD, or my horrible work ethic, and obviously it feels better to blame on the ADHD. But be it the laziness or the inability to focus, I still have to find a way to learn efficiently, such that knowledge flows into my mind coherently, with every node of information inter-connected. This does not mean that the learning process gets easier, as I have just stated, but to make it more efficient: so that things I learn stay in my head for as long as possible. This is difficult by nature, because for the average person, there would certainly be topics that could not be fully understood right away. Learning is connecting the dots, and some dots can only be connected much later. I write these notes with a goal in mind: to make things as intuitively as possible, meaning that the flow of things should be smooth and efficient. To do this, certain concepts will be mentioned briefly, and then accepted as is, without further proof or explanation; we will come back to those in later parts. I hope that after Im done with writing this, I would realize that I will have to go back and change a lot of things. Or, the better alternative would be that I still go back and change things, but after each chapter, when I become a little less ignorant. I believe life has meanings, and the noblest of all is that we live to change the world, no matter how small that effort might be. I think statistics is great tool for such task, because life is nothing more than chances. But lets be clear here: Im not trying to control fate (if it even exists at all). If anything, Im trying to learn to accept fate, because I have came to understand that the best things in life can happen when you think less and believe more. I met my girlfriend this way, and she is the greatest fortune of my life, so why should I try to outsmart the man upstair? "],["draft-outline.html", "1 Draft outline", " 1 Draft outline Thng kê mô t c bn (basic descriptive statistics) Xác sut (probability) S dng p/p Bootstrap  tìm khong tin cy (Using bootstrap to find confidence interval) "],["to-do.html", "2 To-do", " 2 To-do Citation!!! "],["references.html", "3 References", " 3 References Mathematical Statistics with Resampling and R - Laura M. Chihara, Tim C. Hesterberg OpenIntro Statistics - Christopher D. Barr, David M. Diez, and Mine Çetinkaya-Rundel An Introduction to Statistical Methods &amp; Data Analysis - Lyman Ott, Michael Longnecker "],["review-l-i-toán.html", "4 Review li toán 4.1 Hàm s m và hàm s logarit 4.2 Eulers number \\(e\\) 4.3 Mt s im cn lu ý v gii hn 4.4 Toán hc t hp", " 4 Review li toán # load sn ggplot2 (ã bao gm trong tidyverse) library(tidyverse, quietly = TRUE) library(kableExtra) 4.1 Hàm s m và hàm s logarit 4.1.1 Hàm s m nh ngha Hàm s \\(f(x) = b^x\\) là mt hàm s m nu \\(b&gt;0\\) và \\(b \\neq 1\\). Tính cht \\(f(0) = 1\\), hay nói cách khác, mi  th ca hàm s m u i qua im \\((0,1)\\), bt k giá tr ca \\(b\\). \\(f(x) \\neq 0\\) \\(f(x) &gt; 0\\) Tp xác nh (domain - u vào) ca \\(f(x)\\): \\((-\\infty, \\infty)\\), là các giá tr \\(x\\) khin hàm s xác nh Khong bin thiên (range - u ra) ca \\(f(x)\\): \\((0, \\infty)\\), là các giá tr \\(y\\) hp l Nu \\(0&lt;b&lt;1\\): \\(f(x) \\to 0\\) khi \\(x \\to \\infty\\) \\(f(x) \\to \\infty\\) khi \\(x\\to-\\infty\\) Nói cách khác, \\(f(x)\\) ng bin (tng) t trái qua phi nu \\(0&lt;b&lt;1\\) Nu \\(b&gt;1\\): \\(f(x) \\to \\infty\\) khi \\(x \\to \\infty\\) \\(f(x) \\to 0\\) khi \\(x\\to-\\infty\\) Nói cách khác, \\(f(x)\\) nghch bin (gim) t trái qua phi nu \\(b&gt;1\\) Phn này cn nh  tính gii hn (limit), nht là các gii hn có dng vô nh (indeterminate form). 4.1.2 Hàm s logarit nh ngha Hàm s m \\(x=b^y\\) vi \\(b\\neq1, b&gt;0\\) có dng logarit là: \\(y=log_{b}x\\). Hàm s logarit t nhiên (natural logarithm) có dng: \\(lnx=log_{e}x\\), vi c s (base) là \\(e\\). Hàm s logarit thp phân có s s là 10, có dng: \\(logx=log_{10}x\\). Tính cht Tp xác nh (domain - u vào) ca \\(f(x)\\): \\((0, \\infty)\\), là các giá tr \\(x\\) khin hàm s xác nh Khong bin thiên (range - u ra) ca \\(f(x)\\): \\((-\\infty, \\infty)\\), là các giá tr \\(y\\) hp l \\(log_{b}b=1\\) \\(log_{b}1=0\\) \\(log_{b}b^x=x\\) \\(b^{log_{b}x}=x\\) T 2 tính cht trên, ta có: nu \\(g(x)=log_{b}x\\) và \\(f(x)=b^x\\) thì $f(x)=g^{-1}(x), hay nói cách khác, \\(f(x)\\) là hàm ngc (inverse function) ca \\(g(x)\\) \\(log_{b}xy=log_{b}x + log_{b}y\\) \\(log_{b}(\\frac{x}{y})=log_{b}x-log_{b}y\\) \\(log_{b}(x^r)=rlog_{b}x\\) Quy tc i c s Ta có: \\[log_{b}x=\\frac{log_{a}x}{log_{a}b}\\] Ví d: \\(log_{b}x=\\frac{lnx}{lnb}\\) 4.2 Eulers number \\(e\\) 4.2.1 Tng trng ly tin Ta có nh ngha \\(e\\): \\[\\begin{aligned} e &amp;=\\lim_{n\\to\\infty} \\left(1+\\frac{1}{n}\\right)^n \\\\ &amp;=\\lim_{n\\to0} \\left(1+\\frac{1}{n}\\right)^\\frac{1}{n} \\\\ &amp;= 2.71828... \\end{aligned} \\] \\(e\\) là mt hng s toán hc tng t vi \\(\\pi\\),  ch c 2 hng s này u din gii các mi quan h trong t nhiên. i vi \\(\\pi\\), ó là mi quan h gia bán kính và chu vi ng tròn, còn vi \\(e\\), ó là tc  tng trng ca s vt khi chúng tng trng vi tc  tng ng vi chính quy mô ca s vt ó. Nghe thì có v phc tp, nhng thc t mô hình tng trng này là mô hình tng trng ca rt nhiu s vt và hin tng trong t nhiên. i vi kinh t-tài chính, ta có tc  tng trng lãi kép (continuous compound interest) khi u t và liên tc (continuously) tái u t li các khon lãi. i vi các hin tng t nhiên, ta có tng trng dân s, hay thm chí là tng trng âm (gim xung) i vi nhit . Cn phân bit exponential growth và polynomial growth. Exponential growth có th dch sang ting vit là tng trng ly tin, còn polynomial growth là tng trng ly tha. Ví d, dãy s [1, 2, 4, 8, 16, ] ang tng trng ly tha theo \\(x^2\\). 4.2.2 nh ngha e vi dãy s vô hn \\(e\\) còn c nh ngha là tng ca dãy s vô hn: \\[\\begin{aligned} e &amp;=\\sum_{k=0}^{\\infty} \\frac{1}{k!} \\\\ &amp;=\\frac{1}{1!}+\\frac{1}{2!}+\\frac{1}{3!}+\\frac{1}{4!}+... \\end{aligned} \\] nh ngha này có th chng minh c t nh ngha u tiên: Ta có nh lý nh thc (Binomial Theorem): \\[(x+y)^n=\\sum_{k=0}^{n}{n \\choose k}x^{n-k}y^k\\] Trong ó: \\({n \\choose k}=\\frac{n!}{k!(n-k)!}\\) là h s nh thc. Suy ra: \\[\\begin{aligned} e &amp;=(1+\\frac{1}{n})^n \\\\ &amp;=\\sum_{k=0}^{n}{n \\choose k}\\frac{1}{n^k} \\\\ &amp;=\\sum_{k=0}^{n}\\frac{n!}{k!(n-k)!}\\frac{1}{n^k} \\\\ &amp;=\\sum_{k=0}^{n}\\frac{1}{n^k}A(n,k)\\frac{1}{k!},\\ \\ \\ A(n,k)=n(n-1)(n-2)(n-3)...\\\\ &amp;=\\sum_{k=0}^{n}\\frac{1}{k!}\\frac{n}{n}\\frac{n-1}{n}\\frac{n-2}{n}\\frac{n-3}{n}...\\\\ \\end{aligned} \\] Khi \\(n \\to \\infty\\), mi phn t trong tng  trên \\(\\to \\frac{1}{k!}\\). Vì vy: \\(e=\\left(1+\\frac{1}{n}\\right)^n\\to\\sum_{k=0}^{\\infty}\\frac{1}{k!}\\) Hay: \\(e=\\lim_{n\\to\\infty} \\left(1+\\frac{1}{n}\\right)^n=\\sum_{k=0}^{\\infty}\\frac{1}{k!}\\) 4.2.3 o hàm ca \\(exp(x)\\) 4.3 Mt s im cn lu ý v gii hn 4.3.1 Quy tc LHospital Quy tc LHospital c s dng  tính gii hn ca mt s dng gii hn vô nh (indeterminate forms) nh \\(0/0\\), \\(\\pm\\infty/\\pm\\infty\\), \\((0)(\\pm\\infty)\\), \\(1^{\\infty}\\), \\(0^0\\), \\(\\infty^0\\), \\(\\infty-\\infty\\). Quy tc c s dng nh sau: Nu ta có mt trong các dng sau ây: \\[\\lim_{x\\to a}\\frac{f(x)}{g(x)}=\\frac{0}{0}\\] hoc: \\[\\lim_{x\\to a}\\frac{f(x)}{g(x)}=\\frac{\\pm\\infty}{\\pm\\infty}\\] vi \\(a\\in \\mathbf{R}\\) hoc \\(a=\\pm\\infty\\). Khi ó ta có: \\[\\lim_{x\\to a}\\frac{f(x)}{g(x)}=\\lim_{x\\to a}\\frac{f&#39;(x)}{g&#39;(x)}\\] 4.3.2 Chng minh nh ngha \\(e^x\\) t nh ngha ca \\(e\\) T nh ngha ca \\(e\\), khi s dng quy tc LHospital, có th chng minh c: \\[e^x=\\lim_{n\\to\\infty}\\left(1+\\frac{x}{n}\\right)^n\\] Có \\(y=\\left(1+\\frac{x}{n}\\right)^n\\) Nh vy: \\[ \\begin{aligned} ln(y)&amp;=ln\\left[\\left(1+\\frac{x}{n}\\right)^n\\right] \\\\ \\iff\\ln(y)&amp;=n.ln\\left(\\frac{n+x}{n}\\right) \\\\ \\iff\\lim_{n\\to\\infty}\\ln(y)&amp;=\\lim_{n\\to\\infty}n.ln\\left(\\frac{n+x}{n}\\right) \\\\ &amp;=\\lim_{n\\to\\infty}\\frac{ln\\left(\\frac{n+x}{n}\\right)}{\\frac{1}{n}} \\\\ &amp;=\\lim_{n\\to\\infty}\\frac{\\frac{n}{n+x}\\frac{-x}{n^2}}{\\frac{-1}{n^2}} \\\\ &amp;=\\lim_{n\\to\\infty}\\frac{xn}{n+x} \\\\ &amp;=\\lim_{n\\to\\infty}x \\\\ &amp;=x \\end{aligned} \\] Tc là: \\[ \\begin{aligned} x &amp;=\\lim_{n\\to\\infty}\\ln(y) \\\\ \\iff e^x&amp;=e^{\\lim_{n\\to\\infty}\\ln(y)} \\\\ &amp;=\\lim_{n\\to\\infty}e^{ln(y)} \\\\ &amp;=\\lim_{n\\to\\infty}y \\\\ &amp;=\\lim_{n\\to\\infty}\\left(1+\\frac{x}{n}\\right)^n \\\\ \\end{aligned} \\] Ta s dùng li nh ngha này  chng minh công thc PMF ca phân phi Poisson. 4.4 Toán hc t hp Ngoài vic bn cht toán hc t hp (Combinatorics) ã khó, mi th còn tr nên khó hn vì mng toán này có rt nhiu kí hiu và thut ng, cng nh s khác bit trong thut ng ca ting Anh và ting Vit. 4.4.1 Các vn  c bn 4.4.1.1 Quy tc cng và quy tc nhân Quy tc cng (Sum Rule): Cho \\(S_1, S_2,..., S_m\\) là các tp hp hu hn không giao nhau (không có phn t chung - mutually disjoint), và \\(|S_i|=n_i\\) vi \\(1\\leq i\\leq m\\). S cách  chn mt phn t t các tp hp \\(S_1, S_2,..., S_m\\) là tng ca \\(n_1+n_2+...+n_m\\). Quy tc nhân (Product Rule): Cho \\(S_1, S_2,..., S_m\\) là các tp hp hu hn, và \\(|S_i|=n_i\\) vi \\(1\\leq i\\leq m\\). S cách  chn mt phn t t \\(S_1\\), sau ó chn tip mt phn t t \\(S_2\\), và tip tc n mt phn t t \\(S_m\\), là tích ca \\(n_1n_2...n_m\\). iu kin  áp dng quy tc nhân là tt c mi la chn u c lp, hay nói cách khác, mi phn t chn t \\(S_1\\) n \\(S_{i-1}\\) không nh hng n la chn t \\(S_i\\), vi mi \\(i\\). 4.4.1.2 Vn  1 - Hoán v (Permutation) Câu hi: Có bao nhiêu cách  sp xp có th t mt tp hp \\(n\\) phn t? Ví d: Có bao nhiêu cách  tráo mt b bài gm 52 lá bài? Có bao nhiêu cách  sp xp 10 quyn sách trên mt giá sách? Chú ý rng vic sp xp trong các ví d này u có th t, tc là \\(1,2,3,4\\) s khác vi \\(1,4,3,2\\), cho dù c 2 tp hp này có các phn t ging ht nhau. nh ngha Cho \\(A\\) là mt tp hp hu hn có \\(n\\) phn t, \\(n\\geqslant1\\). Hoán v ca \\(A\\) là mt cách sp xp th t \\(n\\) phn t ca \\(A\\). Nói cách khác, mt hoán v ca \\(A\\) là ánh x 1-1 (one-to-one mapping) ca \\(A\\) lên chính nó. Wikipedia nh ngha permutation nh sau: Permutations can be defined as bijections from a set S onto itself.  miêu t c th mt hoán v ca tp hp \\(A\\), trc tiên ta lit kê các phn t ca \\(A\\), cng nh v trí mà mi phn t c chuyn n (qua ánh x). iu kin ca ánh x là 1-1 (one-to-one), ngha là không tn ti hai phn t ca \\(A\\) c chuyn n cùng mt phn t khác ca \\(A\\) thông qua ánh x. Pphép hoán v cng c nh ngha là mt cách sp xp th t \\(n\\) phn t ca \\(A\\). Ví d, nu có tp hp \\(A=\\{1,2,3,4\\}\\) là mt dãy s có th t, ta th hin vic sp xp li th t nh sau: \\[\\sigma={1\\ \\ 2\\ \\ 3\\ \\ 4\\choose 2\\ \\ 1\\ \\ 4\\ \\ 3}\\] Khi cn thc hin nhiu phép hoán v vi mt tp hp \\(A\\) c nh có th t, ta ch cn vit ra dòng di và hiu rng ây là mt cách sp xp li ca \\(A\\). Ví d, vi \\(A=\\{1,2,3\\}\\), các cách sp xp có th xy ra là: \\[123,132,213,231,312,321\\]  m s hoán v có th xy ra ca mt tp hp \\(A=\\{a_1, a_2, a_3, ...,a_n\\}\\) vi \\(n\\) phn t, ta có th suy lun ra vi logic là: Có \\(n\\) cách sp xp phn t u tiên, \\(a_1\\), Có \\(n-1\\) cách sp xp \\(a_2\\); ta ly \\(n-1\\) vì ch còn \\(n-1\\) phn t  chn ra trong \\(A\\) và tha mãn iu kin ánh x 1-1, Tng t, có \\(n-2\\) cách sp xp \\(a_3\\), và c tip tc nh vy n ht. T ó ta tính ra c bng sau: data.frame(&quot;n&quot;=1:10) %&gt;% mutate(&quot;n!&quot;=factorial(n)) %&gt;% rename(&quot;S phn t&quot;=n, &quot;S cách sp xp&quot;=&quot;n!&quot;) %&gt;% kableExtra::kable() %&gt;% kableExtra::kable_styling(full_width = F) S phn t S cách sp xp 1 1 2 2 3 6 4 24 5 120 6 720 7 5040 8 40320 9 362880 10 3628800 T ó ã có công thc tính s hoán v ca \\(A\\) vi \\(n\\) phn t là: \\[P_n=n!=n(n-1)(n-2)(n-3)...\\cdot3\\cdot2\\cdot1\\] 4.4.1.3 Vn  2 - Chnh hp Câu hi: Có bao nhiêu cách  to ra mt nhóm có th t ca \\(k\\) phn t, chn ra t mt tp hp ban u có \\(n\\) phn t? Ví d: Có bao nhiêu cách  mt bng xp hng sp xp 20 i bóng tt nht trong ó 100 i bóng ca toàn gii u? Có bao nhiêu cách  mt ban nhc chi mt danh sách gm 12 bài hát nu h ch bit chi tng cng 25 bài? Chnh hp (arrangement) thc cht là mt trng hp c bit ca hoán v, và trong ting Anh còn c gi là \\(k\\)-permutations of \\(n\\), tc là chnh hp chp \\(k\\) ca \\(n\\) phn t. nh ngha Cho tp hp \\(A\\) gm \\(n\\) phn t. Mt b gm \\(k\\) \\((1\\leq k\\leq n)\\) phn t sp xp th t ca tp hp \\(A\\) c gi là mt chnh hp chp \\(k\\) ca \\(n\\) phn t ca tp hp \\(A\\). \\[\\begin{aligned} A^n_k &amp;= A(n,k) \\\\ &amp;=n\\cdot(n-1)\\cdot...\\cdot(n-k+1) \\\\ &amp;=\\frac{n!}{(n-k)!} \\end{aligned} \\]  m s chnh hp chp \\(k\\) ca \\(n\\) vi tp hp \\(A=\\{a_1, a_2, a_3, ...,a_n\\}\\), ta s dng quy tc m nh sau: Có \\(n\\) cách sp xp phn t u tiên, \\(a_1\\)  a vào mt b \\(k\\) phn t, Có \\(n-1\\) cách sp xp \\(a_2\\); ta ly \\(n-1\\) vì ch còn \\(n-1\\) phn t trong \\(A\\)  chn, Tng t, có \\(n-2\\) cách sp xp \\(a_3\\), và c tip tc nh vy, n khi ã chn ra c  \\(k\\) phn t, lúc này ta ã chn n phn t \\(a_k\\) trong \\(A\\), và phn t này có \\(n-k+1\\) cách chn. Ta hình dung tp hp \\(A\\) nh sau: \\[A=\\{\\underbrace{a_1,...,a_{k-1}}_{k-1\\ phn\\ t}, a_k,a_{k+1},...,a_n\\}\\] Khi chn n phn t th \\(k-1\\) (tc là ch còn 1 ch trong b \\(k\\) phn t), ta ã có \\(k-1\\) phn t. Nh vy phn t th \\(k\\) c chn ra s có \\([n-(k-1)]=n-k+1\\) cách chn. 4.4.1.4 Vn  3 - T hp Câu hi: Có bao nhiêu cách  chn ra \\(k\\) phn t t mt tp hp \\(n\\) phn t, nu th t không quan trng? Ví d: Có bao nhiêu cách  bc ra 5 lá bài (cho mt hand trong poker) t b bài gm 52 lá? Th t ca 5 lá bài này không quan trng vì ngi chi có th tu ý sp xp mà không nh hng n cách chi. nh ngha: T hp chp \\(k\\) ca \\(n\\) phn t là: \\[{n \\choose k}=C(n,k)=\\frac{A(n,k)}{k!}=\\frac{n!}{k!(n-k)!}\\] Ta chng minh c công thc t hp t công thc ca hoán v và chnh hp nh sau: Chn ra \\(k\\) phn t t tp hp \\(n\\) phn t, ta có s cách chn là mt s \\(C\\). Vi mi cách chn, ta sp xp li \\(k\\) phn t c chn, nh vy s cách chn là hoán v ca \\(k\\) phn t và bng \\(k!\\). Nh vy, s cách  chn ra \\(k\\) phn t có th t t \\(n\\) phn t là \\(C \\cdot k!\\). ng thi, s chn này còn bng \\(A(n,k)\\), t nh ngha chnh hp. Có ngha là: \\[C={n \\choose k}=\\frac{A(n,k)}{k!}=\\frac{n!}{k!(n-k)!}\\] S \\({n \\choose k}\\) còn c gi là h s nh thc. 4.4.2 H s nh thc Mt s tính cht ca h s nh thc (binomial coefficient): Công thc t hp: \\[ {n \\choose k}= \\begin{cases} \\frac{n!}{k!(n-k)!}=\\frac{n^{\\underline{k}}}{k!}=\\frac{P(n,k}{k!} \\quad if \\;0 \\leq k \\leq n, \\\\ 0 \\quad otherwise \\end{cases} \\] Tính i xng: \\({n \\choose k}={n \\choose n-k}\\) Phép cng: \\({n \\choose k}={n-1 \\choose k}+{n-1 \\choose k-1}\\) nh lý nh thc: \\[(x+y)^n=\\sum_{k=0}^n {n \\choose k}x^ky^{n-k}\\] Tng ca dãy s nh thc: \\(\\sum_{k=0}^n{n \\choose k}=2^n\\), when \\(x=1 \\;and\\;y=1\\) Summing over lower index (or symmetry. Accross row \\(n\\) of Pascals Triangle): \\[\\sum_{k}(-1)^k{n \\choose k}= \\begin{cases} 0 \\;if\\;n\\geq1 \\\\ 1 \\;if\\;n=0 \\end{cases} \\] Summing over upper index (i.e. summing by column in Pascals Triangle): \\[\\sum_{k=0}^n{k \\choose m}={n+1 \\choose m+1}\\] vi \\(m\\) là th t ct, và \\(n\\) là th t dòng. Sau khi cng li, ta có tng ca tt c các giá tr trong ct \\(m\\), tính t dòng \\(0\\) n dòng \\(n\\). Vandermondes identity: \\[{m+n \\choose r}=\\sum_{k}{m \\choose k}{n \\choose r-k}\\] Ý ngha &amp; Ví d: Gi s có mt nhóm gm \\(m\\) nam và \\(n\\) n. S cách  chn mt nhóm nh gm \\(r\\) thành viên, trong ó có \\(k\\) nam và \\(r-k\\) n là: Khi chn trc tip t nhóm ban u gm \\(m+n\\) ngi, ta có: \\({m+n \\choose r}\\) Khi chn ln lt \\(k\\) nam t \\(m\\) nam và \\(r-k\\) n t \\(n\\) n, ta có: \\(\\sum{m \\choose k}{n \\choose r-k}\\) 4.4.3 Mt s kin thc liên quan 4.4.3.1 Tim cn Khái nim Cho \\(a_n\\) và \\(b_n\\) là hai dãy s. Ta gi \\(a_n\\) là tim cn vi \\(b_n\\) và vit là \\(a_n \\sim b_n\\), nu: \\[\\lim_{n\\to\\infty}\\frac{a_n}{b_n}=1\\] 4.4.3.2 Công thc Stirling Khi \\(n\\) ngày càng ln, vic tính toán chính xác \\(n!\\) tr nên không thc tin. Vì vy ta có th áp dng _công thc Stirling$  c lng nh sau. Dãy \\(n!\\) tim cn vi: \\[n^ne^{-n}\\sqrt{2\\pi n}\\] S dng R, ta có th kim chng công thc Stirling: stirling &lt;- function(n){ s=n^n*exp(1)^(-n)*sqrt(2*pi*n) return(s) } data.frame(&quot;n&quot;=1:10) %&gt;% mutate(&quot;Factorial&quot;=factorial(n), &quot;Approx&quot;=format(round(stirling(n), 3), nsmall = 3), &quot;Ratio&quot;=format(round(Factorial/stirling(n), 3), nsmall = 3)) %&gt;% kableExtra::kable() %&gt;% kableExtra::kable_styling(full_width = F) n Factorial Approx Ratio 1 1 0.922 1.084 2 2 1.919 1.042 3 6 5.836 1.028 4 24 23.506 1.021 5 120 118.019 1.017 6 720 710.078 1.014 7 5040 4980.396 1.012 8 40320 39902.395 1.010 9 362880 359536.873 1.009 10 3628800 3598695.619 1.008 4.4.3.3 im c nh im c nh (Fixed points) là các im ca mt hàm s mà ti ó \\(f(x)=x\\). Vi hoán v, im c nh là các im mà ti ó, v trí ca các phn t trong hoán v không i so vi tp hp \\(A\\) ban u. Ta có th s dng th vin arrangements trong R và ly sample 10000 hoán v vi \\(n=10,20,30\\), s có kt qu nh sau: library(arrangements) f &lt;- data.frame(matrix(ncol = 4, nrow = 0)) colnames(f) &lt;- c(&quot;rs&quot;,&quot;avg_fixed_points&quot;,&quot;fraction&quot;,&quot;n&quot;) avg_fixed &lt;- c() for (i in 1:3) { n &lt;- i*10 s &lt;- 100000 p &lt;- data.frame(permutations(n,n,nsample = s)) for (j in 1:n){ p[[paste0(&#39;X&#39;,j)]] &lt;- (p[[paste0(&#39;X&#39;,j)]] == j)*1 } p$rs &lt;- rowSums(p[1:n]) f &lt;- rbind(f, p %&gt;% filter(rs&lt;=5) %&gt;% group_by(rs) %&gt;% summarise(fraction=n()/s, .groups=&quot;drop&quot;) %&gt;% mutate(n=n) ) avg_fixed &lt;- append(avg_fixed, mean(p$rs)) } rbind(f, data.frame(&quot;rs&quot;=rep(&quot;Avg. fixed points&quot;,each=3), &quot;fraction&quot;=avg_fixed, &quot;n&quot;=c(10,20,30) ) ) %&gt;% pivot_wider(names_from = n, values_from = fraction) %&gt;% kableExtra::kable() %&gt;% kableExtra::kable_styling(full_width = F) rs 10 20 30 0 0.36571 0.37196 0.36606 1 0.36943 0.36974 0.36998 2 0.18444 0.17927 0.18459 3 0.06127 0.06064 0.06043 4 0.01547 0.01503 0.01539 5 0.00311 0.00278 0.00288 Avg. fixed points 1.00306 0.98776 1.00051 Có th thy, xác sut hoán v không có im c nh nào khi \\(n=10,20,30\\) giao ng trong khong 0.36 n 0.37. Nu ly toàn b mi hoán v (thay vì ly 10000 sample), ta s tính c chính xác xác sut này hn và nhn c kt qu là 0.367879, và kt qu này xp x \\(1/e\\). Có th s dng file FixedPoints.R  tính vi trng hp \\(n=10\\). Tuy nhiên, phng pháp này lit kê mi hoán v có th xy ra, vì vy ch có th tính c vi \\(n=10\\). Nh vy, vi \\(n&gt;=10\\), xác sut  mt hoán v ngu nhiên không có im c nh nào không ph thuc vào \\(n\\). Ta cng thy rng s im c nh trung bình qua thí nghim va ri tng ng vi 1. Trong thc t, trung bình s im c nh s bng 1 vi mi \\(n\\). 4.4.4 Mt s ghi chú v ký hiu Trong giáo trình Vit Nam, ký hiu chnh hp là \\(A^k_n\\). Ký hiu này có l c ly t Pháp. Trong giáo trình ting Anh, chnh hp thng c gp chung vào vi hoán v và là trng hp c bit ca hoán v, và thng c ký hiu là \\(P^k_n\\) hoc \\(P(n,k)\\). Trên các máy tính b túi, ta cng thng thy ký hiu \\(P\\) và \\(C\\)  tính chnh hp và t hp. Mt s dòng máy ca Casio s s dng cú pháp \\(nPk\\) và \\(nCk\\)  tính t hp và chnh hp. 4.4.5 Bài tp Tham kho bài tp v toán t hp ti ây: Li gii bài tp cho sách Combinatorics and Graph Theory - John Harris "],["xác-su-t-c-b-n.html", "5 Xác sut c bn 5.1 Mt s nh ngha c bn 5.2 Lý thuyt tp hp 5.3 Các phép toán/quan h tp hp 5.4 Quy lut xác sut 5.5 Bin ngu nhiên ri rc 5.6 Các phân phi ri rc ph bin 5.7 Bin ngu nhiên liên tc 5.8 Các phân phi liên tc ph bin", " 5 Xác sut c bn # load sn ggplot2 (ã bao gm trong tidyverse) library(tidyverse, quietly = TRUE) library(venn) 5.1 Mt s nh ngha c bn Probability: Likelihood, relative frequency, chance. Outcome: Kt qu/bin s -&gt; Là mt quan sát (observation) ca mt thí nghim (experiment) ngu nhiên, ví d: mt ln tung xúc xc. Trong mc này ta s gi nguyên t outcome. Experiment: quá trình dn n mt hoc nhiu outcome. Sample space: Không gian mu -&gt; tp hp tt c các outcome ca thí nghim, còn c gi là universal set. T này chúng ta s c gng s dng ting Vit. Event: S kin -&gt; là tp hp các outcome vi xác sut nht nh. Ví d: Ln xúc xc ra s nh hn 3. Có 3 cách hiu v xác sut: clasical, relative frequency và subjective. 5.2 Lý thuyt tp hp 5.2.1 Biu  Venn library(VennDiagram, quietly = TRUE) t \\(S\\) là tp hp tt c các outcome ca thí nghim ngu nhiên (tc là sample space). Trong ó, chúng ta quan tâm n hai s kin \\(A\\) và \\(B\\). S dng biu  Venn  th hin các s kin, vi thí nghim là ln mt ln xúc xc có 6 mt, tc là \\(S = \\{1,2,3,4,5,6\\}\\), vi: \\(A\\) là ln xúc xc ra s l \\(B\\) là ln xúc xc ra ln hn 5 5.3 Các phép toán/quan h tp hp 5.3.1 Phép hp (Union) Phép hp th hin hoc A và B s sy ra (quan h either or), c ký hiu là \\(A\\cup B\\). 5.3.2 Phép giao (intersection) Phép giao th hin s kin c A và B cùng xy ra (both), ký hiu là \\(A\\cap B\\). 5.3.3 Phn bù (Complement) Phn bù tng i, hay còn gi là phép hiu (difference), ký hiu là \\(A \\setminus B\\). ây là tp hp các phn t có trong A nhng không có trong B. Phn bù tuyt i (absolute complement) Phn bù tuyt i ca tp hp A  th hin s kin A không xy ra, tng ng vi tt c các outcome không thuc A, có th nm trong mt không gian mu toàn th khác. 5.3.4 Loi tr ln nhau (Mutually exclusive) Quan h loi tr ln nhau (hay còn gi là xung khc) - mutually exclusiveness/disjoint - ký hiu là \\(\\bar{A}\\) hoc \\(A^{C}\\). nh ngha 1. Hai s kin A và B c gi là loi tr ln nhau nu s xy ra ca s kin này ngn vic xy ra ca s kin kia. Ví d: Trong 1 ln  xúc xc, s 2 và s 5 không th cùng xy ra. 5.4 Quy lut xác sut 5.4.1 Các quy lut c bn Trong phn này, ta s dng biu  Venn, c th là phn din tích trong biu ,  th hin xác sut ca mt s kin. nh ngha 2. Xác sut là t l s ln mt s kin xy ra trong nhiu ln th lp li ca mt hin tng ngu nhiên. Nói mt cách khác, xác sut chính là tn sut tng i (relative frequency) v lâu dài. Quy lut 1. Vi bt k s kin \\(A\\), xác sut \\(P(A)\\) luôn tha mãn \\(0\\le P(A) \\le 1\\) vì t l luôn nm trong khong \\([0,1]\\). Quy lut 2. Nu hai s kin loi tr ln nhau, \\(PA \\cup B = P(A) + P(B)\\). Vì S là tp hp tt c các s kin có th xy ra, din tích ca hình ch nht bên ngoài biu  s là 1 và xác sut ca s kin A c th hin bng din tích hình tròn A. Khi A và B loi tr ln nhau, A và B là hai hình tròn tách bit. 5.4.2 Xác sut có iu kin (conditional probability)  phn trc, chúng ta xem xét các mi quan h tp hp, s dng  th hin s liên quan ca 2 s kin A và B. Tuy nhiên, vi phép hp hay phép giao, A và B không có mi quan h ph thuc.  phn này, ta xem xét tip tình hung có t hai s kin tr lên xy ra, và mt s kin din ra trc s kin còn li, tc là tr thành iu kin ca s kin còn li. Xác sut ca A xy ra nu B ã xy ra c vit là \\(P(A|B)\\), còn có th gi là xác sut ca A vi iu kin B. Ví d 1:  hình dung rõ ràng hn v xác sut có iu kin, ta xét mt ví d cc kì n gin: Nu tung hai ng xu cùng mt lúc, ta có 4 outcome là \\(\\{hh, ht, th, tt\\}\\) (h là head, t là tail). Nh vy xác sut tung c hai ng xu ra mt nga là 25% (\\(1/4\\)). Thay vì tung cùng mt lúc, ta tung ln lt. Nu ng xu th nht ra mt nga, thì xác sut  c hai u nga sau khi tung nt ng xu th hai là bao nhiêu? Nu ngh mt cách n gin theo common sense, ta thy nu bây gi ch còn mt ng xu  tung thì ch còn hai kt qu hoc sp hoc nga. Vy rõ ràng xác sut là 50%? Nu  ý k hn, ta thy không gian mu ban u b thu nh li và ch còn hai kh nng xy ra: \\(\\{hh, ht\\}\\), tc là \\(P(H | H) = 1/2\\). Ví d 2: trò chi roullette truyn thng có 37 ô, tt c u nh nhau (xác sut nh nhau = 1/37). Có 18 ô , 18 ô en, kèm vi 1 ô s 0. Trong s các ô  có 8 ô s chn (và 10 l); trong s các ô en có 10 ô s sn (và 8 l). Tình hung: Nu vòng roullette c xoay bí mt, và sau ó bn c cho bit là kt qu ri vào ô màu  -&gt; tính xác sut kt qu cng là s l? Trc tiên cn nh ngha 2 s kin A và B: S kin A: kt qu ra là ô màu  S kin B: kt qu ra là s l Hai s kin này có mi quan h là: A xy ra trc, và xác sut ca B ph thuc vào A. Tc là s khác vi vic A và B xy ra cùng lúc (intersection). Vi tình hung xác sut có iu kin nh th này, không gian mu ca B s ph thuc vào A, và không còn là không gian mu ban u na (37 ô). Nu kt qu là mt ô màu , và có 10 trong s 18 ô  là s l, thì \\(P(odd|red) = 10/18 = 5/9\\). Có th thy t s là 18, thay vì là 37, vì ta ang xét trên không gian mu nh hn là tp các ô có màu . So sánh vi 2 trng hp: \\(P(odd) = 18/37\\), tc là không gian mu có 37 outcome. \\(P(odd giao red) = 10/37\\), tc là không gian mu vn có 37 outcome. Trng hp này, có th hiu là ta tính xác sut ca s kin kt qu xy ra va có màu , va là s l, mà không có iu kin nào i trc. Ví d 3: Chúng ta xét tip mt ví d tng t, nhng s dng mt bng xác sut  d hình dung hn: \\(\\,\\) Fire Auto Other Fraudulant 6% 1% 3% non-Fraudulant 14% 29% 47% Trên ây là d liu v các case òi bi thng bo him và t l la o, ly t sách An Introduction to Statistical Methods &amp; Data Analysis (Ott &amp; Longnecker). Ví d trên vi vòng xoay roullette có không gian mu toàn th là \\(P(Color \\cap Parity)\\) (màu sc giao vi tính chn l).  ví d này, d liu chính là \\(P(Category \\cap PolicyType)\\). Cng dn các ct và các hàng, ta tìm ra c xác sut ca tng hng mc (category) và tng loi hp ng bo him (policy). \\(\\,\\) Fire Auto Other \\(\\,\\) Fraudulant 6% 1% 3% 10% non-Fraudulant 14% 29% 47% 90% \\(\\,\\) 20% 30% 50% 100% Có th thy các case òi bi thng do cháy n d có kh nng la o hn các case loi khác. Ta tính c t l s case la o liên quan n cháy n là: \\[\\begin{aligned} P(\\textrm{ Fraud }|\\textrm{ FirePolicy }) &amp;= \\frac{\\textrm{proportion of claims that are fire policies and are fraudulent}}{\\textrm{proportion of fire claims}} \\\\ &amp;= \\frac{6\\%}{20\\%}\\\\ &amp; \\\\ &amp;= 0.3 \\end{aligned}\\] Nh vy, có th nh ngha xác sut có iu kin (vi gi thit \\(P(B) \\ne 0\\)) là: \\[P(A|B)=\\frac{P(A\\cap B)}{P(B)}\\] Công thc trên có th vit li thành: \\[\\begin{aligned} P(A\\cap B) &amp;= P(A\\,|\\,B)\\,P(B) \\\\ &amp;= P(B\\,|\\,A)\\,P(A) \\end{aligned}\\] Vì th t không quan trng và \\(P\\left(A\\cap B\\right)=P\\left(B\\cap A\\right)\\). S dng quy lut này, ta tính c xác sut mt case òi bi thng là hp ng Auto vi iu kin case này không la o: \\[\\begin{aligned} P\\left(\\,Auto\\;|\\;NotFraud\\,\\right) &amp;= \\frac{P\\left(\\,Auto\\;\\cap\\;NotFraud\\right)}{P\\left(\\,NotFraud\\,\\right)} \\\\ &amp;= \\frac{0.29}{0.9} \\\\ &amp; \\\\ &amp;= 0.3\\bar{2} \\end{aligned}\\] Ví d 4: Gi s bn là mt nhà nghiên cu th trng v in thoi, và bn thu thp c d liu (gi nh, không phi d liu tht) vi các thông tin v hãng (Apple vs Samsung) và gii tính ngi dùng (nam vs n). Trong d liu, in thoi Apple chim 40% th phn. iu này có ngha là \\(P(Apple) = 0.40\\). Trong s in thoi Apple, s ngi s dng là nam ch chim 35%, tc là \\(P(Men|Apple) = 0.35\\). Tuy nhiên, trong s ngi dùng Samsung, s lng nam li nhiu hn, vì vy \\(P(Men|Samsung) = 0.60\\). Vi các thông tin trên, ta có bng sau: \\(\\,\\) Samsung Apple \\(\\,\\) Nam N \\(\\,\\) 60% 40% 100% Có th in thêm các thông tin còn thiu trong bng bng cách s dng nh ngha xác sut có iu kin. Ví d: \\[\\begin{aligned} P\\left(Men\\,\\cap\\,Samsung\\right) &amp;= P\\left(Men\\,|\\,Samsung\\right)\\,P\\left(Samsung\\right) \\\\ &amp;= 0.60*0.60 \\\\ &amp;= 0.36 \\end{aligned}\\] Nh vy s lng in thoi là Samsung có ngi dùng nam là 0.36%. Tng t, ta tính c: \\[\\begin{aligned} P\\left(Men\\,\\cap\\,Apple\\right) &amp;= P\\left(Men\\,|\\,Apple\\right)\\,P\\left(Apple\\right) \\\\ &amp;= 0.35*0.40 \\\\ &amp;= 0.14 \\end{aligned}\\] T ó, có bng hoàn chnh nh sau: \\(\\,\\) Samsung Apple \\(\\,\\) Nam 36% 14% 50% N 24% 26% 50% \\(\\,\\) 60% 40% 100% Tóm li, các con s 36% hay 14% là c da trên không gian d liu toàn th, bao gm toàn b s lng in thoi c s dng trong phân tích. Nu chúng ta gii hn không gian này trong s in thoi Samsung hay Apple, các con s trên s thay i (thành 60% và 35%). 5.4.2.1 Tính c lâp Hai s kin ngoài quan h ph thuc vào nhau còn có th c lp hoàn toàn vi nhau. Ta có nh ngha: nh ngha 3. Hai s kin A và B c coi là c lp nu \\(P(A|B) = P(A)\\) và \\(P(B|A) = P(B)\\). Hiu theo cách khác, vic bit các outcome ca s kin A không cho ta thông tin gì v các coutcome ca s kin B, tc là xác sut ca A gi nguyên cho dù B có xy ra hay không. Vi phng pháp ly mu ngu nhiên c bn (random sampling), ta thng gi nh rng hai bin bt k luôn c lp. Quy lut 3.. Nu A và B là hai s kin c lp, thì \\(P(A /cap B) = P(A|B)P(B) = P(A)P(B)\\). 5.4.3 Tng hp quy lut xác sut \\[0 \\le P\\left(A\\right) \\le 1\\] \\[P\\left(A\\right)+P\\left(\\bar{A}\\right)=1\\] \\[P\\left(A\\cup B\\right) = P\\left(A\\right)+P\\left(B\\right)-P\\left(A\\cap B\\right)\\] \\[P\\left(A\\cap B\\right) = \\begin{cases} P\\left(A\\,|\\,B\\right)P\\left(B\\right)\\\\ P\\left(B\\,|\\,A\\right)P\\left(A\\right)\\\\ P(A)P(B)\\;\\; &amp; \\textrm{ nu A, B c lp} \\end{cases}\\] \\[P\\left(A\\,|\\,B\\right) = \\frac{P\\left(A\\cap B\\right)}{P\\left(B\\right)}\\] 5.5 Bin ngu nhiên ri rc Trong thc t, lý thuyt xác sut c s dng  tính toán kh nng xy ra ca nhiu loi s kin khác nhau, bao gm các s kin mang tính nh lng (quantitative) và nh tính (qualitative). Ví d: vi các s kin mà kt qu thu v không o m c, d liu có th là các câu tr li ng ý hoc Không ng ý thu c t mt bn survey, và c xp loi vào mt bin nh tính. Mt khác, các d liu v thi gian, trng lng, etc. thng c xp loi vào mt bin nh lng. Chúng ta có th a ra nh ngha v hai loi bin ngu nhiên này: Bin ngu nhiên liên tc (random continuous variable - bin nh lng): là bin bao gm các giá tr có dng s (numeric) và, trên lý thuyt, có th nhn mt s lng giá tr không m c. Nói cách khác, nêu giá tr s có th din t hoc bin i theo kiu s thp phân hoc phân s, giá tr này thng là kiu liên tc. Trong R, d liu liên tc thng là kiu numeric. Bin ngu nhiên ri rc (random discrete variable - nh tính): là bin nhn mt tp hp các giá tr có th m c. Nói cách khác, nu vic din t giá tr  dng phân s hoc thp phân tr nên vô ngha, giá tr thng s là kiu ri rc. Nêu các quan sát ca mt bin bin nh lng ch có th nhn mt s các giá tr nht nh, bin này cng c coi l ri rc. Trong R, d liu ri rc thng là kiu factor hoc string. 5.5.1 Gii thiu v bin ngu nhiên ri rc (NNRR) Các quy lut sau áp dng vi bin NNRR: Xác sut ca mi giá tr nm gia khong 0 và 1 Tng xác sut ca tt c các giá tr bng 1 Xác xut ca các bin NNRR có th cng vi nhau, tc là \\(P(3 \\ hoc \\ 4) = P(3) + P(4)\\) 5.5.1.1 Giá tr k vng Ví d: Xét bin NNRR \\(S\\) là tng kt qu ca s kin th 2 xúc xc. Ta có biu  th hin xác sut ca các giá tr mà \\(S\\) CÓ TH NHN: Xác sut thng c áp dng  a ra các phng oán v tng lai, và mt khái nim c bn c x dng là giá tr k vng (expected value) Trong trng hp tung xúc xc, ta có giá tr k vng \\(E[S]\\) chính là mean ca tp hp \\(D\\) gm tt c các giá tr mà \\(S\\) có th nhn. Ta bit trc c mi giá tr mà \\(S\\) có th nhn vì tp hp này không ln và d dàng suy ra c. Trong thc t, vic có toàn b population là him khi xy ra, nên ta thng ly mt sample rt ln và tìm giá tr k vng bng cách tính sample mean, hay nói cách khác là weighted average ca các giá tr có th nhn c, vi trng s là xác sut (hay frequency) ca tng giá tr. \\[\\mu=E[S] = \\sum_{\\textrm{possible }s}\\;s\\cdot P\\left(S=s\\right)\\] Trong ví d trên, ta có: \\[\\begin{aligned} \\mu = E[S] &amp;= \\sum_{s=2}^{12}s\\cdot P(S=s) \\\\ &amp;= 2\\cdot P\\left(S=2\\right)+3\\cdot P\\left(S=3\\right)+\\dots+11\\cdot P\\left(S=11\\right)+12\\cdot P\\left(S=12\\right) \\\\ &amp;= 2\\left(\\frac{1}{36}\\right)+3\\left(\\frac{2}{36}\\right)+\\dots+11\\left(\\frac{2}{36}\\right)+12\\left(\\frac{1}{36}\\right) \\\\ &amp;= 7 \\end{aligned}\\] Sau khi ã bit \\(E[S]\\) trong ví d trên, ta tip tc thí nghim bng cách tung 2 xúc sc 100 ln: x &lt;- sample(seq(2,12, by=2), size = 100, prob = rep(1/6, 6), replace = TRUE) mean(x) ## [1] 7.12 Có th thy trong thí nghim này, giá tr trung bình không bng vi \\(E[S]\\). Nu lp li thí nghim này vi s ln \\(n\\) ln hn thì khi \\(n\\) tin ti vô hn, giá tr trung bình s tin ti giá tr k vng. 5.5.1.2 Phng sai Tng t, ta nh ngha phng sai (variance) ca S (ký hiu là \\(\\sigma^{2}\\)) là weighted average ca bình phng  lch chun (squared-deviation) có th xy ra: \\[ \\sigma^{2}=V[S] = \\sum_{\\textrm{possible }s}\\; (s-\\mu)^2 \\cdot P\\left(S=s\\right)\\] Trong ví d trên, \\(\\sigma^{2}\\) bng: \\[\\begin{aligned} \\sigma^{2}=V[S] &amp;= \\sum_{s=2}^{12}\\left(s-\\mu\\right)^{2}P(S=s) \\\\ &amp;= (2-7)^{2}\\left(\\frac{1}{36}\\right)+(3-7)^{2}\\left(\\frac{2}{36}\\right)+\\dots+(12-7)^{2}\\left(\\frac{1}{36}\\right) \\\\ &amp;= \\frac{35}{6}=5.8\\bar{3} \\end{aligned}\\] Phng sai và giá tr k vng là 2 i lng quan trng  nh ngha và miêu t mt phân phi xác sut. (???) 5.6 Các phân phi ri rc ph bin 5.6.1 Binomial distribution - PP nh thc 5.6.1.1 nh ngha Ví d: Gi s có ba chic by c t ti ba v trí trong rng. Ba v trí này xa nhau   không nh hng n xác sut ca các by khác bt c thú. Ta có: S kin by bt c thú là \\(C_i\\) S kin by trng là \\(E_i\\) Xác sut by bt c thú là \\(\\pi = 0.8\\) Các kt qu có th nhn c là: Outcome \\(\\,\\) \\(E_1, E_2, E_3\\) \\(\\,\\) \\(C_1, E_2, E_3\\) \\(\\,\\) \\(E_1, C_2, E_3\\) \\(\\,\\) \\(E_1, E_2, C_3\\) \\(\\,\\) \\(C_1, C_2, E_3\\) \\(\\,\\) \\(C_1, E_2, C_3\\) \\(\\,\\) \\(E_1, C_2, C_3\\) \\(\\,\\) \\(C_1, C_2, C_3\\) \\(\\,\\) Vì các by  xa nhau nên kt qu ca tng by là c lp vi nhau. Ta có: \\[ P(E_1 \\cap E_2 \\cap E_3) = P(E_1)P(E_2)P(E_3) = (1 - 0.8)0.8(1-0.8) = 0.032\\] Tng t, ta tính c xác sut ca các kt qu còn li trong bng: Outcome Probability \\(S\\) Outcome Probability \\(E_1, E_2, E_3\\) 0.008 \\(S=0\\) 0.008 -  -  \\(C_1, E_2, E_3\\) 0.032 \\(E_1, C_2, E_3\\) 0.032 \\(S=1\\) \\(3(0.032) = 0.096\\) \\(E_1, E_2, C_3\\) 0.032 -  -  \\(C_1, C_2, E_3\\) 0.128 \\(C_1, E_2, C_3\\) 0.128 \\(S=2\\) \\(3(0.128) = 0.384\\) \\(E_1, C_2, C_3\\) 0.128 -  -  \\(C_1, C_2, C_3\\) 0.512 \\(S=3\\) \\(0.512\\) Tip ó, ta xét n bin ngu nhiên \\(S\\) và tng hp c xác sut ca các giá tr mà \\(S\\) nhn c, tng ng vi s by bt c mi: \\(S\\) Outcome Probability \\(S=0\\) \\(0.008=0.2^3\\cdot0.8^0\\) \\(S=1\\) \\(0.096=3\\cdot0.2^2\\cdot0.8^1\\) \\(S=2\\) \\(0.384=3\\cdot0.2\\cdot0.8^2\\) \\(S=3\\) \\(0.512=0.2^0\\cdot0.8^3\\) Do các s kin có tính c lp vi nhau nên tng xác sut ca mi s kin bng \\(0.008 + 0.096 + 0.384 + 0.512 = 1\\). ng thi, ta cng nhn thy rng:  mi by, xác sut  by có bt k outcome nào là \\(\\pi + 1 - \\pi = 1\\) Do có 3 by, nên tng xác sut là: \\[\\begin{aligned} (\\pi + (1-\\pi))^3 &amp;= \\pi^3 + 3\\pi(1-\\pi)^2 + 3\\pi^2(1-\\pi) + (1-\\pi)^3 \\\\ &amp;= 1 \\end{aligned}\\] Tc là trong trng hp tng quát vi \\(n\\) ln th, ta s dng nh lý nh thc, trong ó mi phn t tng ng vi xác sut mà bin \\(S\\) nhn giá tr \\(k\\) - \\(P(S=k)\\): \\[\\begin{aligned} (\\pi + (1-\\pi))^n &amp;= {n \\choose 0}\\pi^n + {n \\choose 1}\\pi^{n-1}(1-\\pi)^1 + ... + {n \\choose n-1}\\pi^1(1-\\pi)^{n-1} + (1-\\pi)^n \\\\ &amp;= \\sum_{k=0}^{n}{n \\choose k}\\pi^{k}(1-\\pi)^{n-k} \\end{aligned}\\] Nh vy,  tính \\(P(S=k)\\), ta ch cn s dng công thc (hay còn gi là hàm khi xác sut - probability mass function - pmf) sau: \\[P(S=k)=\\underbrace{\\frac{n!}{x!(n-k)!}}_{h\\ s\\ nh\\ thc}\\;\\underbrace{\\pi^{x}}_{k\\,thành\\ công}\\;\\underbrace{(1-\\pi)^{n-x}}_{n-k\\,tht\\ bi}\\] H s nh thc chính là s t hp chp \\(k\\) ca \\(n\\) phn t, có th hiu là: có \\(\\frac{n!}{x!(n-k)!}\\) cách phân phi \\(k\\) ln thành công và \\(n-k\\) ln tht bi trong \\(n\\) ln th. Nh vy, phân phi nh thc là phân phi áp ng các iu kin sau: Thí nghim bao gm \\(n\\) ln th ging nhau Mi ln th có th có 2 kt qu: thành công hoc tht bi/úng hoc sai. Xác sut thành công trong mi phép th là \\(\\pi\\) là gi nguyên gia các phép th Các phép th có tính c lâp vi nhau Tn ti mt bin ngu nhiên \\(S\\) là s ln thành công trong \\(n\\) phép th Trong R, ta s dng hàm dbinom  mô phng li phân phi nh thc: dist &lt;- data.frame(x=0:3) %&gt;% mutate(xs=dbinom(x,size=3,prob=0.8)) ggplot(dist, aes(x=x)) + geom_point(aes(y=xs)) + geom_linerange(aes(ymax=xs, ymin=0)) + ggtitle(&#39;phân phi nh phân: n=3, p=0.8&#39;) + theme_bw() Trong  th trên,  tính chiu cao các ng tn sut, ta s dng hàm pmf ti im tng ng. \\[\\begin{aligned} P(S=2) &amp;= {3 \\choose 2} (0.8)^2(1-0.8)^{3-2} \\\\ &amp;=\\frac{3!}{2!(3-2)!}(0.8)^2(0.2)^{3-2} \\\\ &amp;= 0.384 \\end{aligned}\\] Trong R, vi mi phân phi xác sut, thng s có 4 nhóm function vi vai trò khác nhau: Nhóm d-function: Tính chiu cao ca hàm pmf (hoc pdf). Vi bin NNRR \\(Y\\), d-function tr v kt qu tng ng vi \\(P(Y=y)\\) vi \\(y\\) bt k. Nhóm p-function: Tính \\(P(Y\\le y)\\), tc là xác sut  \\(Y\\) nhn giá tr nh hn hoc bng \\(y\\). Nhóm q-function: Tìm quantile nht nh ca phân phi. Ví d, giá tr nào chia phân phi ti các ngng 25% và 75%? Nhóm r-function: Ly mt sample ngu nhiên t phân phi. Trong hân phi nh thc, 4 hàm tng ng là dbinom, pbinom, qbinom và rbinom. 5.6.1.2 Giá tr k vng ca phân phi nh thc Xét ví d n gin sau: Nêu tung 100 ng xu, vi \\(X\\) là s ln ra mt nga (head), ta có \\(E[X] = 50 = \\frac{1}{2}100\\) Hoc: Mt bài kim tra có 20 câu hi, mi câu 4 áp án. Nu chn ngu nhiên cho c 20 câu, s câu úng k vng là \\(\\frac{1}{4}20 = 5\\). Tóm li, có th thy vi phân phi nh thc, \\(E[X]=n\\pi\\). Ta chng minh công thc này nh sau:  phn trc, ta có vi mt phân phi xác sut nói chung, \\(E[X]\\) là mean ca 1 sample  ln, tc là \\(E[X] = \\sum\\;x\\cdot P\\left(X=x\\right)\\). Suy ra vi phân phi nh thc: \\[\\begin{aligned} E[X] &amp;= x \\cdot P\\left(X=x\\right) \\\\ &amp;=\\sum_{x=0}^{n}x{n \\choose x}\\pi^x(1-\\pi)^{n-x} \\\\ \\end{aligned}\\] Khi \\(x=0\\), phn t u tiên trong tng cng bng 0 nên: \\[\\begin{aligned} E[X] &amp;= x \\cdot P\\left(X=x\\right) \\\\ &amp;=\\sum_{x=0}^{n}x{n \\choose x}\\pi^x(1-\\pi)^{n-x} \\\\ &amp;=\\sum_{x=1}^{n}x{n \\choose x}\\pi^x(1-\\pi)^{n-x} \\\\ &amp;=\\sum_{x=1}^{n}x\\frac{n!}{x!(n-x)!}\\pi^x(1-\\pi)^{n-x} \\\\ &amp;=\\sum_{x=1}^{n}n\\frac{(n-1)!}{(x-1)!((n-1)-(x-1))!}\\pi^x(1-\\pi)^{n-x} \\\\ &amp;=n\\pi\\sum_{x=1}^{n}{n-1 \\choose x-1}\\pi^{x-1}(1-\\pi)^{(n-1)-(x-1)} \\\\ \\end{aligned}\\] Áp dng nh lý nh thc: \\[\\begin{aligned} E[X] &amp;= \\vdots \\\\ &amp;=n\\pi(\\pi+(1-\\pi))^{n-1} \\\\ &amp;=n\\pi \\cdot 1^{n-1} \\\\ &amp;=n\\pi \\end{aligned}\\] Tng t, phng sai c tính bng: \\[\\begin{aligned} V[X] &amp;= \\sum_{x=0}^{n}\\left(x-E\\left[X\\right]\\right)^{2}\\,P\\left(X=x|n,\\pi\\right) \\\\ &amp;= \\sum_{x=0}^{n}\\left(x-E\\left[X\\right]\\right)^{2}\\;\\frac{n!}{x!\\left(n-x\\right)!}\\pi^{x}\\left(1-\\pi\\right)^{n-x} \\\\ &amp;= \\vdots \\\\ &amp;= n\\pi(1-\\pi) \\end{aligned}\\] 5.6.2 Poisson distribution - PP Poisson Phân phi Poisson c to ra vi mc ích mô hình hóa s lng s kin din ra trong mt khong thi gian nht nh, hay m rng ra là trong mt gii hn c nh. Ví d: S lng khách hàng thanh toán mi ting s lng hu trên mi 1000 hecta s lng búi to trong mi mét khi nc h Các d kin trên là mt kiu tc /tn sut thay i, trong PP Poisson ký hiu là \\(\\lambda\\). S dng phân phi Poisson, ta có th d oán c xác sut mà s lng s kin nào ó có th xy ra trong mt gii hn c nh. 5.6.2.1 So sánh vi PP nh thc Các ví d lit kê  trên có th gii quyt c bng cách s dng PP nh thc, do ta ang tính xác sut xy ra s s kin thành công (KH có thanh toán, hu có tn ti, etc.), gi là \\(P(X)\\). Tuy nhiên, cn nhiu thông tin hn  tính \\(P(X)\\), bao gm xác sut thành công \\(\\pi\\) và tng s ln th \\(n\\). Trong khi ó,  bài a ra li ch có \\(\\lambda\\) là d kin  dng t l tng/tc : s KH thanh toán/ting, s hu/hecta, etc, hay nói cách khác chính là giá tr k vng \\(E[X]\\). Nh vy, thách thc u tiên gp phi là PP nh thc cn nhiu d kin hn, trong khi Poisson ch cn 1 thông tin duy nht. Tip ó, ta nhn thy nu tính c xác sut thành công trên mi n v thi gian hoc không gian, ta gp phi vn  là PP nh thc không cha c NHIU HN MT s kin trong mt n v thi gian/không gian tng ng. Có th gii quyt vn  này bng cách chia nh n v thi gian/không gian ra, ví d chia 1 ting thành 60 phút, hoc thm chí nh hn. Tuy nhiên, kt qu a ra s luôn gp gii hn trong vic fit vi d liu thc t. 5.6.2.2 nh ngha &amp; chng minh PP Poisson T ví d trên, có th thy v mt toán hc, \\(n \\to \\infty\\), do càng chia nh i lng thi gian/không gian, s s kin cha c trong mi n v càng tng. Vì \\(E[X]\\) c nh nên \\(p \\to 0\\), do \\(E[X]= \\lambda = np\\). Nh vy, ta có th suy ra công thc tính pmf ca PP Poisson t pmf ca PP nh thc nh sau: \\[\\begin{aligned} P(Y=k) &amp;=\\lim_{n\\to\\infty}{n \\choose k} \\pi^k (1-\\pi)^{n-k} \\\\ &amp;=\\lim_{n\\to\\infty}{n \\choose k} \\left(\\frac{\\lambda}{n} \\right)^k \\left(1-\\frac{\\lambda}{n} \\right)^{n-k} \\\\ &amp;=\\lim_{n\\to\\infty} \\frac{n!}{(n-k)!k!} \\frac{1}{n^k} \\lambda^k \\left(1-\\frac{\\lambda}{n}\\right)^n \\left(1-\\frac{\\lambda}{n}\\right)^{-k} \\\\ &amp;= \\lim_{n\\to\\infty} \\underbrace{\\frac{n!}{(n-k)!} \\frac{1}{n^k}}_{=1} \\; \\underbrace{\\frac{\\lambda^k}{k!} \\left(1-\\frac{\\lambda}{n}\\right)^n}_{Poisson\\ PMF} \\; \\underbrace{\\left(1-\\frac{\\lambda}{n}\\right)^{-k}}_{=1} \\\\ &amp;= \\underbrace{\\frac{\\lambda^k}{k!} \\; e^{-\\lambda}}_{Poisson\\ PMF} \\end{aligned}\\] Phn chng minh c th cho tng tha s nm  ph lc cui chng. Nh vy ta có: Vi bin ngu nhiên \\(Y\\) nhn giá tr \\(y\\) là s s kin thành công trong mt n v thi gian/không gian nào ó, hay nói cách khác là hàm khi xác sut pmf là: \\[\\underbrace{\\frac{\\lambda^k}{k!} \\; e^{-\\lambda}}_{Poisson\\ PMF}\\] vi \\(\\lambda\\) là s s kin k vng xy ra trong mt n v thi gian/không gian và \\(e\\) là \\(2.718281828\\dots\\) (base of natural logarithm). T ó, ta suy ra: \\[E[Y] = \\lambda\\] \\[Var[Y] = \\lambda\\] Ví d: Có \\(Y\\) là s khách hàng thanh toán ti quy ca 1 ca hàng tp hóa trong vòng 12 ting. Gi s \\(Y\\sim Poi(\\lambda=2.3)\\). Hi: Xác sut có 4 KH thanh toán trong 12 ting? \\[P(Y=4) = \\frac{2.3^4e^{-2.3}}{4!} = 0.1169\\] Xác sut có nhiu nht 4 KH? \\[\\begin{aligned} P(Y\\le4) &amp;= P(Y=0)+P(Y=1)+P(Y=2)+P(Y=3)+P(Y=4) \\\\ &amp;= 0.1003+0.2306+0.2652+0.2033+0.1169 \\\\ &amp;= 0.9163 \\end{aligned}\\] Xác sut có nhiu hn hoc bng 5 KH? \\[P(Y\\ge5)=1-P(Y\\le4) =1-0.9163 =0.0837\\] Các phép tính trên có th thc hin trên R vi 4 nhóm hàm tng t nh PP nh thc: dist &lt;- data.frame( NumCaught = 0:10 ) %&gt;% mutate( probability = dpois( NumCaught, lambda=2.3 ) ) ggplot(dist, aes(x=NumCaught)) + geom_point( aes(y=probability) ) + geom_linerange(aes( ymax=probability, ymin=0)) + ggtitle(expression(paste(&#39;Poisson Distribution with &#39;, lambda == 2.3))) + labs(x=&#39;Number Caught&#39;) + theme_bw() # P( Y = 4) dpois(4, lambda=2.3) ## [1] 0.1169022 # P( Y &lt;= 4) ppois(4, lambda=2.3) ## [1] 0.9162493 # 1-P(Y &lt;= 4) == P( Y &gt; 4) == P( Y &gt;= 5) 1-ppois(4, 2.3) ## [1] 0.08375072 5.7 Bin ngu nhiên liên tc Bin ngu nhiên liên tc (NNLT) có th nhn s lng vô hn giá tr, dn n nhiu s khác bit v toán hc kahs hóc búa so vi bin NNRR. C th, xác sut  bin NNLT \\(X\\) nhn giá tr \\(x\\) bng 0, vì vy chúng ta s tìm xác sut bin \\(X\\) ri vào mt khong nht nh. Vì th, thay vì ly tng xác sut, ta s ly tích phân. Do tài liu này không chuyên sâu v toán nên thay vào ó ta u tiên s dng R  tính hn, nhng vn s i sâu vào 1 s công thc toán cn thit  hiu sâu v bn cht. 5.7.1 PDF, CDF và CCDF 5.7.1.1 PDF - Hàm mt  xác sut Vi các PP liên tc, ta s dng PDF (probability density function) thay vì PMF (probability mass function - hàm khi xác sut). PMF là hàm  tính xác sut ca mt bin ngu nhiên \\(X\\) nhn giá tr \\(x\\), tc là \\(P(X=x)\\). ng thi, tng xác sut ca mi \\(x\\) mà \\(X\\) có th nhn bng 1. Khi biu din trên  th, ta thy xác sut ca mi tng ng vi mi giá tr \\(x\\) ca bin NNRR \\(X\\) chính là chiu cao ca ca các bar. #insert a graph here to demonstrate!!! Tuy nhiên, vi bin NNLT, do không th tìm c xác sut ca 1 giá tr \\(x\\) c th, ta s quan tâm ti phn din tích bên di  th, c th là  gia mt khong 2 giá tr \\([a,b]\\) nào ó, tng ng vi xác sut mà bin \\(X\\) nhn giá tr trong khong này. Cng cn lu ý rng, xác sut mà bin \\(X\\) nhn giá tr trong khong \\([a,b]\\) không s dng hàm PDF  tính. Hàm PDF ch dùng  biu din mt  xác sut. 5.7.1.2 CDF - Hàm phân phi tích lu Coi \\(f(x)\\) là mt hàm PDF và \\(F(x)\\) là CDF tng ng. Hàm \\(f(x)\\) có th nhn giá tr bt k t 0 n \\(\\infty\\), vi iu kin phn din tích di \\(f(x)\\) bng 1, i.e. tích phân ca \\(f(x)\\) bng 1, hay \\(\\int_{-\\infty}^{x} f(t) dt = 1\\). Khi mun tìm xác sut t hàm PDF, ta phi ly tích phân ca \\(f(x)\\) gia 2 giá tr \\(a\\) và \\(b\\). Nu giá tr bên trái, tc là \\(a = -\\infty\\), ta có CDF chính là \\(P(X \\leq b)\\). Ngc li vi CDF, ta còn quan tâm n CCDF (complementary CDF)  tìm \\(P(X&gt;b)\\), hay chính là \\(1-P(X \\leq b) = 1 - CDF\\) 5.8 Các phân phi liên tc ph bin 5.8.1 Exponential distribution - PP m PP m c s dng  mô hình hóa và d oán khong thi gian gia 2 s kin liên tc, i.e. thi gian ch n s kin tip theo. Ví d: thi gian n khi KH tip theo thanh toán thi gian ch gia 2 ln ón ca xe buýt T nh ngha này, có th thy PP m có liên quan cht ch n PP Poisson (tính xác sut s s kin thành công trong 1 n v thi gian/không gian). PP Poisson cho ta bit v s s kin thành công trong mi khong thi gian, ng thi PP m giúp ta miêu t khong thi gian gia mi s kin. 5.8.1.1 PDF ca PP m PP m có PDF nh sau: \\[f(t)=\\begin{cases} \\lambda e^{-\\lambda t} &amp; t\\ge0\\;\\textrm{ and }\\;\\lambda&gt;0\\\\ 0 &amp; \\textrm{otherwise} \\end{cases}\\] Có th suy ra công thc PDF trên t công thc PDF ca PP Poisson. Hai phân phi m và Poisson u bt ngun t Poisson process, trong ó có \\(\\lambda\\) là event rate, i.e. s s kin trong mi n v thi gian. Nh vy, trung bình s có \\(\\lambda t\\) s kin xy ra trong \\(t\\) n v thi gian. T công thc PMF ca Poisson: \\(\\textrm{Có } P(x) = e^{-\\lambda t}(\\lambda t)^x / x! \\\\ \\Leftrightarrow P(x=0) = e^{-\\lambda t} \\\\ \\textrm{Coi T là thi gian ch n s kin tip theo, ta có T &gt; t} \\equiv \\textrm{x = 0} \\\\ \\Leftrightarrow P(T&gt;t) = e^{-\\lambda t}\\\\ \\Leftrightarrow P(T \\leq t) = 1 - e^{-\\lambda t}\\) ây là chính là CDF ca PP m, tc là khi ly o hàm, ta có PDF: \\[F(t) = \\int_{0}^{\\infty} \\lambda e^{-\\lambda t} dt = 1-e^{-\\lambda t}\\]  trên, ta ã có \\(\\lambda t\\) s kin xy ra trong \\(t\\) n v thi gian, tc là: \\(n = \\lambda t \\\\ \\Leftrightarrow t/n = 1/\\lambda\\) Hay din t bng li, ta có: thi gian trung bình n khi s kin tip theo din ra là \\(1/\\lambda\\), tng ng vi: \\[\\mu = E[X] = \\frac{1}_{\\lambda}\\] ng thi, phng sai ca PP m là: \\[\\sigma^2 = Var[X] = \\int_{0}^{\\infty} (x-\\mu)^2 f(x) dx = \\dots = frac{1}_{\\lambda^2}\\] 5.8.2 Uniform [0,1] distribution 5.8.3 Normal distribution d "],["th-ng-kê-mô-t-c-b-n.html", "6 Thng kê mô t c bn 6.1 Tóm tt d liu qua  th 6.2 Xu hng trung tâm 6.3 Mc  phân tán (Spread/Dispersion) 6.4 Tip tc vi biu  6.5 Tng hp thut ng 6.6 Mt s bài tp 6.7 Tham kho", " 6 Thng kê mô t c bn # load sn ggplot2 (ã bao gm trong tidyverse) library(tidyverse, quietly = TRUE) Summary statistics (thng kê mô t tóm tt) là mt phn c bn trong khoa hc thng kê, giúp chúng ta mô t ngn gn d liu thông qua các ch s thng kê c bn nht. ng thi, chúng ta cng s dng các công c visualization trong R  a data tr thành 1 biu  mang mc ích tóm tt. Trong phn này, chúng ta s s dng dataset TenMileRace t package mosaicData. # Cài package nu cha có sn install.packages(&#39;mosaicData&#39;) data(TenMileRace, package=&#39;mosaicData&#39;) summary(TenMileRace) ## state time net age sex ## VA :3689 Min. : 2816 Min. : 2814 Min. :10.00 F:4325 ## MD :2166 1st Qu.: 5125 1st Qu.: 4950 1st Qu.:28.00 M:4311 ## DC :1642 Median : 5806 Median : 5555 Median :35.00 ## PA : 273 Mean : 5813 Mean : 5599 Mean :36.86 ## NY : 211 3rd Qu.: 6455 3rd Qu.: 6169 3rd Qu.:44.00 ## NJ : 92 Max. :10603 Max. :10536 Max. :87.00 ## (Other): 563 head(TenMileRace) ## state time net age sex ## 1 VA 6060 5978 12 M ## 2 MD 4515 4457 13 M ## 3 VA 5026 4928 13 M ## 4 MD 4229 4229 14 M ## 5 MD 5293 5076 14 M ## 6 VA 6234 5968 14 M Dataset này có các ct sau: state: Là ni sng ca ngi chy. time: Thi gian chính thc t lúc bt u chy n lúc chm vch ích (tính bng giây). net: Thi gian ghi c (theo giây) t lúc ngi chy vt qua vch bt u cho n lúc chm vch ích. Giá tr này thng nh hn giá tr time do có mt s lng ln ngi tham gia chy, và không th sp xp cho ngi tham gia ng thng hàng  xut phát cùng 1 lúc c (need citation here). age: Tui ca ngi tham gia chy tính bng nm. sex: Gii tính ngi tham gia chy, thuc dng factor vi 2 giá tr F (female) vàd M (male). Trc tiên, chúng ta cn phân bit gia 2 loi d liu: Discrete/Categorical (d liu ri rc): Là kiu d liu có giá tr nm trong 1 tp hp gii hn có th m c. Nu d liu là kiu numeric, ta có th gi là Discrete, còn nu là kiu factor/string, ta gi là Categorical. Ví d: Xp hng im ca hc sinh theo kiu ch cái (A/B/C/D/E/F) hoc gii tính (Nam hoc N), hoc s ba n trong ngày (1 n 3 ba, thm chí nhiu hn, nhng quan trng là chúng ta có th m c). Continuous (d liu liên tc): Là kiu d liu s có th nhn mt s giá tr vô hn, không th m c. Ví d: Chiu cao, cân nng, thi gian/tui (ví d: Có th nói là 10 tui, nhng cng có th nói là 10 tui 5 tháng 20 ngày 7 phút 5 giây, vân vân). Tóm li, khi làm vic vi d liu, chúng ta có th t t câu hi: Liu có th chia các giá tr trong dataset này thành các phn nh hn hay không?. Nu có, d liu s thuc kiu liên tc. 6.1 Tóm tt d liu qua  th 6.1.1 Mt bin ri rc (univariate) Chúng ta có th dùng bar chart  mô t phân phi ca mt bin ri rc (n bin - univariate). Các ct (bar) c v th hin mt giá tr (level) ca nhóm factor, và chiu cao ca ct (nu  biu  dc) th hin s quan sát (observation). Ta cng có th dùng group_by và summarise  din gii bar chart nh  di: TenMileRace %&gt;% group_by(sex) %&gt;% summarise(count = n()) ## `summarise()` ungrouping output (override with `.groups` argument) ## # A tibble: 2 x 2 ## sex count ## &lt;fct&gt; &lt;int&gt; ## 1 F 4325 ## 2 M 4311 ggplot(TenMileRace, aes(x=sex)) + geom_bar() Có th thy 2 ct có chiu cao tng ng nhau do s observation ca mi giá tr factor gn bng nhau (4325 vs. 4311). Nh vy, d liu v ngi chy ua trong data rt cân bng v gii tính. 6.1.2 Mt bin liên tc (univariate)  th histogram nhìn khá ging vi  th bar chart, nhng vì c s dng vi bin liên tc nên các ct s chm vào nhau. ggplot(TenMileRace, aes(x=net)) + geom_histogram() Chiu cao ca mi ct trong  th histogram th hin tn sut kt qu chy theo các khong (interval), và trong R gi là các bin (ngn). Mc nh ca hàm geom_histogram là bins=30, tc là mi khong cách nhau 30 n v. Ta có th din gii li biu  trên di dng bng: TenMileRace %&gt;% mutate(bins=cut(net, breaks=30)) %&gt;% group_by(bins) %&gt;% summarise(count=n()) ## `summarise()` ungrouping output (override with `.groups` argument) ## # A tibble: 29 x 2 ## bins count ## &lt;fct&gt; &lt;int&gt; ## 1 (2.81e+03,3.07e+03] 18 ## 2 (3.07e+03,3.33e+03] 22 ## 3 (3.33e+03,3.59e+03] 65 ## 4 (3.59e+03,3.84e+03] 131 ## 5 (3.84e+03,4.1e+03] 197 ## 6 (4.1e+03,4.36e+03] 339 ## 7 (4.36e+03,4.62e+03] 495 ## 8 (4.62e+03,4.87e+03] 685 ## 9 (4.87e+03,5.13e+03] 735 ## 10 (5.13e+03,5.39e+03] 1004 ## # ... with 19 more rows các interval trong bng và  th trên u có mc nh là \\((x, y]\\), tc là \\(x &lt; values &lt;= y\\) (right-closed, left-opened). Chú ý:  th histogram da vào din tích ca các ct, không phi chiu cao, tc là bng \\(bin\\;width\\;*\\;count\\). 6.1.3 Mt bin ri rc và mt bin liên tc (bivariate) Chúng ta thng phi so sánh mc  phn hi (d liu liên tc) ca hai bin ri rc hoc nhiu hn. Biu  boxplot thng  s dng  làm vic này. Mi observation gn vi mt giá tr liên tc và 1 giá tr ri rc ggplot(TenMileRace, aes(x=sex, y=net)) + geom_boxplot() Tron biu  trên, phn rìa (hinge) ca hp c nh ngha là các khong phn t th nht và th 3 (1st quartile, tng ng vi 25% quantile, và 3rd quartile, ng tng vi 75% quantile). Nói cách khác, 25% d liu nm di hp, 50% nm trong hp, và phn 25% cui cùng nm phía trên hp. Các im bên ngoài hp là các outliers (im ngoi lai). Nu nh ngha Inter-Quartile Range (IQR) là chiu dài ca hp thì tt các quan sát ln hn 1.5*IQR tính t hp c coi nh là 1 outlier. Ngoài cách trên, chúng ta có th dùng 2  th histogram t cnh nhau  so sánh: ggplot(TenMileRace, aes(x=net)) + geom_histogram() + facet_grid( . ~ sex ) Trong trng hp này,  th t theo chiu dc s d so sánh hn: ggplot(TenMileRace, aes(x=net)) + geom_histogram() + facet_grid( sex ~ . ) # thay i chiu facet 6.1.4 Hai bin liên tc (bivariate)  biu din mi quan h ca 2 bin liên tc, ta dùng biu ô dng im: ggplot(TenMileRace, aes(x=age, y=net, color=sex)) + geom_point() 6.2 Xu hng trung tâm Ngoài vic s dng các loi biu  và  th, chúng ta còn có th dùng các 1 s ch s c bn  miêu t d liu. M u là các ch s v chiu hng trung tâm (centrality). 6.2.1 Mean (Trung bình cng) Giá tr trung bình cng (arithmetic mean, hay còn c gi là average) là ch s c bn nht, c tính theo công thc: \\[\\bar{x}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}=\\frac{1}{n}\\left(x_{1}+x_{2}+\\dots+x_{n}\\right)\\] Trong R, ta tính mean bng cách dùng hàm mean(): # Dùng base R mean(TenMileRace$net) ## [1] 5599.065 # Dùng dplyr summarise(TenMileRace, mean(net)) ## mean(net) ## 1 5599.065 6.2.2 Median (Trung v) Median (trung v) là giá tr  gia ca 1 tp hp d liu ã sp xp theo th t. Trong trng hp s phn t ca tp hp là s chn, ta ly trung bình cng ca 2 giá tr  gia làm median, tc là ly \\((1/2)(y_{n/2}\\;+\\;y_{(n/2+1)})\\). Trong R, ta tính median bng hàm median(): median(TenMileRace$net) ## [1] 5555 # Dùng dplyr summarise(TenMileRace, median(net)) ## median(net) ## 1 5555 6.2.3 Trimmed mean Giá tr trimmed mean là giá tr trung bình sau khi xén bt mt s phn trm nht nh  2 u phân phi; ví d i vi 5% trimmed mean, sau khi sp xp d liu theo th t, ta ly bt 5% các quan sát u tiên và cui cùng, gi li 90% ri ly trung bình cng. Trong R, ta tính trimmed mean bng hàm mean() kèm theo thông s trim = n: mean(TenMileRace$net, trim=0.5) ## [1] 5555 Có th thy, sau khi xén bt 5% quan sát  2 u phân phi, mean và median ca trng net trong dataset TenMileRace bng nhau. 6.2.4 Ví d Mt lp hc có 9 ngi, tui ca c lp là tp hp \\(\\{21, 22, 23, 25,26,22, 23,21, 26\\}\\). Mean ca tp hp là 23.222, median là 23; hai giá tr này hin ang xp x nhau. Ngi th 10 nhp hc có tui là 71, khin mean ca tp hp tr thành 28.6, median vn gi nguyên là 24. Giá tr mean mi ln hn so vi median, do chúng ta thêm vào 1 outlier ln hn hn. D liu lúc này c gi là lch sang bên phi (skewed). i vi d liu có  lch ln, giá tr median s th hin xu hng trung tâm tt hn mean. age &lt;- c(21, 22, 23, 25,26,22, 23,21, 26) mean(age) ## [1] 23.22222 median(age) ## [1] 23 age &lt;- append(age, 71) # thành viên mi ca lp hc mean(age) ## [1] 28 median(age) ## [1] 23 6.3 Mc  phân tán (Spread/Dispersion) Câu hi th 2 khi làm vic vi 1 dataset là Mc  phân tán ca dataset này nh th nào?. Ví d, ta có 2 tp d liu có các tham s trung tâm tng ng nhau, nhng không có ngha là 2 tp này ging nhau, mà d liu có th phân tán và bin thiên khác nhau. Có nhiu cách  tr li câu hi này: 6.3.1 Range (Khong bin thiên) Range (khong bin thiên) là khong cách gia giá tr quan sát nh nht n giá tr quan sát ln nht. \\[Range=Max-Min\\] TenMileRace %&gt;% summarise(range = max(net) - min(net)) ## range ## 1 7722 6.3.2 Inter-Quartile Range Interquartile range là khong cách gia t phân v th 3 (3rd quartile) và th phân v th nht (1st quartile): \\[IQR=Q3-Q1\\] Trc tiên, cn gii thích nh ngha ca các thut ng -tile: Percentile: Ting Vit ngha là bách phân v; sau khi xp d liu theo th t, giá tr phn trm th \\(p\\) (\\(p_{th}\\) percentile) là giá tr quan sát có \\(p\\) phn trm s quan sát bên di và \\((1-p)\\) bên trên, trong ó \\(p\\) nm gia 0 và 100. Percentile th 0 và 100 là chính là giá tr nh nht và ln nht ca tp d liu. Giá tr median là giá tr phn trm th 50 (50th percentile). Percentile là mt mc, không phi 1 khong d liu. Quartile: Thông thng, chúng ta s chia d liu ra làm 4 phn vi 3 mc 25th percentile, 50th percentile và 75th percentile, tc là chia d liu ra làm 4 phn. Ba mc này cng c gi là 1st, 2nd và 3rd quartiles (khong phn t th nht, th 2 và th 3). Quantile: Là các im ct/im mc chia mt khong phân phi xác sut ra thành các khong vi xác sut ging nhau. Nh vy, quartile và percentile là các trng hp c bit ca quantile. Dùng hàm quantile(): quantile(TenMileRace$net) ## 0% 25% 50% 75% 100% ## 2814 4950 5555 6169 10536 # so sánh giá tr 0%, 50% và 100% # vi các hàm min, max và median c(min(TenMileRace$net), median(TenMileRace$net), max(TenMileRace$net)) ## [1] 2814 5555 10536 Chúng ta có th dùng argument probs trong hàm quantile()  tìm ra các percentile khác: quantile(TenMileRace$net, probs = c(0.05, 0.95)) ## 5% 95% ## 4098.75 7260.50 Giá tr mc nh ca argument probs là 0 (min), 0.25 (1st quartile), 0.5 (2nd quartile/median), 0.75 (third quartile) và 1 (max).  tính IQR, chúng ta hàm IQR (nh vit hoa): IQR(TenMileRace$net) ## [1] 1219 # hoc kt hp vi dplyr TenMileRace %&gt;% summarise(IQR(net)) ## IQR(net) ## 1 1219 Lu ý: hàm quantile mc nh tr v 5 giá tr, vì vy s không kt hp c vi dplyr::summarise do hàm summarise ch tr v 1 kt qu. Nu thay i argument probs thì có th kt hp c. TenMileRace %&gt;% summarise(quantile(net, probs = 0.5)) ## quantile(net, probs = 0.5) ## 1 5555 6.3.3 Variance (Phng sai) Trc tiên, ta xem xét khong cách t mt quan sát bt kì n mean (deviation). Ta nh ngha deviation th \\(i_{th}\\) là: \\[e_{i}=x_{i}-\\bar{x}\\] Vy khong cách trung bình n mean là bao nhiêu? Nu kho sát mc  phân tán bng cách này, ta gp phi 2 vn : Tng ca tt c các khong cách t các quan sát n mean bng 0: \\[\\sum_{i=1}^{n}(x_{i}-\\bar{x}) = \\sum_{i=1}^{n}x_{i}-\\sum_{i=1}^{n}\\bar{x} = n\\frac{1}{n}\\sum_{i=1}^{n}x_{i}-n\\bar{x} = n\\bar{x}-n\\bar{x} = 0\\] Vn  ln hn: Các giá tr khong cách n mean có c giá tr âm và dng, và khi kho sát mc  phân tán, kt qu âm hay dng là vô ngha.  gii quyt vn  này, chúng ta có th ly giá tr tuyt i hoc bình phng kt qu. Nu i theo hng ly giá tr tuyt i, ta dùng ch s MAD (Mean Absolute Deviation), c tính là trung bình ca tng giá tr tuyt i ca khong cách t các observation n mean: \\((1/n)\\sum_{i=1}^{n}|x_{i}-\\bar{x}|\\). Nu i theo hng bình phng kt qu, ta dùng phng sai (variance). Trong thc t, d liu thng  dng mt phân phi chun (normal distribution - s nhc n  phn 2), nh chiu cao con ngi, huyt áp, im thi, giá c phiu, v.v. Phân phi chun c nh ngha bi 2 thông s là mean và variance, và vì mc  quan trng ca phân phi chun, nên variance c s dng nhiu hn khi tính toán mc  phân tán. Sample variance (Phng sai mu), vi \\(\\bar{x}\\) là giá tr trung bình cng ca mu, \\(n\\) là s observation: \\[s^2=\\frac{1}{n-1}\\sum_{i=1}^{n}(x_{i}-\\bar{x})^2\\] Population variance (Phng sai qun th), vi \\(\\mu\\) là giá tr trung bình cng ca qun th, \\(n\\) là s observation: \\[\\sigma^{2}=\\frac{1}{n}\\sum_{i=1}^{n}(x_{i}-\\mu)^2\\] D liu thu thp c thng  dng mt mu ca c qun th. Nu trong trng hp có d liu ca c population, ta s dùng công thc 2.  c 2 công thc, ta ly tng bình phng ca khong cách ti mean, sau ó ly trung bình, tuy nhiên ta chia cho \\((n-1)\\)  tính sample variance (phng sai mu) thay vì chia cho \\(n\\)  tính population variance (phng sai qun th). Ta làm iu này  tránh vic (\\(\\sigma^{2}\\)) b biased - có ngha là nu dùng công thc tính population variance cho mt sample, kt qu tính ra thng nh hn bình thng (do ta ang tính \\(s^2\\), vn là 1 ch s c lng (estimator), da trên 1 ch s c lng khác là \\(\\bar{x}\\)).  tính sample variance trong R, chúng ta s dng hàm var(): var(TenMileRace$net) ## [1] 940233.5 6.3.4 Standard variation ( lch chun) Vn  ln nht ca sample variance là n v  dng bình phng, dn n vic gây khó hiu, khó  dn n kt lun/phân tích.  gii quyt, ta ly giá tr cn bc 2  có c  lch chun mu (sample standard deviation). \\[s=\\sqrt{s^2}\\]  tính  lch chun mu trong R, ta dùng hàm sd(): sd(TenMileRace$net) ## [1] 969.6564 V mt toán hc, phng sai quan trng hn vì nó c s dng làm nh ngha cho các phân phi xác sut, nhng  lch chun d hiu hn và vì th có ích trong thc t hn. 6.3.5 H s bin thiên (Coefficient of variation) Chúng ta xem xét ví d sau: Có 1 nhóm ng vt có  lch chun mu ca chiu dài con vt là 15cm. Ch vi thông tin này, ta gn nh không th a ra kt lun gì có ích. Gi s có thêm thông tin v loài ng vt: Nu là voi: ta có th kt lun nhóm các con voi này có chiu dài rt ng u, do chiu dài trung bình ca c loài voi nói chung s ln hn 15cm rt nhiu, và ta có th da vào common sense  nhn nh rng chiu dài gia các con voi trong nhóm lch nhau rt nh. Nu là côn trùng: ta có th kt lun nhóm côn trùng này có chiu dài rt a dng, thm chí là có nhiu loài côn trùng khác nhau. Trong thc t, loài côn trùng dài nht cng có ch  dài khong 60cm. Nh vy, nu có thêm thông tin v loài ng vt, hay nói cách khác là thông tin giúp ta c lng c chiu dài trung bình ca nhóm ng vt trên, ta s a ra c nhiu kt lun có ích.  gii quyt vn  này, ta có th dùng h s bin thiên: \\[CV = \\frac{s}{|\\bar{x}|}\\] 6.3.6 Quy tc thc nghim Ta có th s dng quy tc thc nghim nh sau  áp dng cho các mu d liu tng i ln và i xng: Khong S lng phn trm quan sát (tng i) \\(\\bar{x}\\pm s\\) 68.3% \\(\\bar{x}\\pm 2s\\) 95.5% \\(\\bar{x}\\pm 3s\\) 99.7% 6.4 Tip tc vi biu  6.4.1 Box plot 6.4.2 Scatter plot 6.4.3 Skewness &amp; Kurtosis 6.5 Tng hp thut ng 6.6 Mt s bài tp 6.7 Tham kho "]]
